
const { Pool } = require('pg');
const path = require('path');
require('dotenv').config({ path: path.resolve(__dirname, '../.env') });

const pool = new Pool({
    connectionString: process.env.DATABASE_URL,
    ssl: { rejectUnauthorized: false }
});

async function createTriggers() {
    const client = await pool.connect();
    try {
        console.log("üöÄ Creating Database Triggers...");

        const functionBody = `
CREATE OR REPLACE FUNCTION sync_school_profiles_to_forms() RETURNS TRIGGER AS $$
BEGIN
`;

        const fullFunction = `${functionBody}

    -- Sync form_school_profile
    INSERT INTO form_school_profile (school_id, iern, school_name, region, division, province, municipality, barangay, district, leg_district, latitude, longitude, curricular_offering, mother_school_id, email, updated_at, submitted_at, submitted_by, history_logs, data_health_score, data_health_description, mahalanobis_score, forms_to_recheck, forms_completed_count, completion_percentage, f1_profile, f2_head, f3_enrollment, f4_classes, f5_teachers, f6_specialization, f7_resources, f8_facilities, f9_shifting, f10_stats, cnt_within_g5, aral_read_g2, aral_sci_g2, aral_math_g3, aral_read_g3, aral_sci_g3, aral_math_g4, aral_read_g4, aral_sci_g4, aral_math_g5, aral_read_g5, aral_sci_g5, aral_math_g6, aral_read_g6, aral_sci_g6, aral_total, cnt_less_kinder, cnt_within_kinder, cnt_above_kinder, cnt_less_g1, cnt_within_g1, cnt_above_g1, cnt_less_g2, cnt_within_g2, cnt_above_g2, cnt_less_g3, cnt_within_g3, cnt_above_g3, cnt_less_g4, cnt_within_g4, cnt_above_g4, cnt_less_g5, cnt_above_g5, cnt_less_g6, cnt_within_g6, cnt_above_g6, cnt_less_g7, cnt_within_g7, cnt_above_g7, cnt_less_g8, cnt_within_g8, cnt_above_g8, cnt_less_g9, cnt_within_g9, cnt_above_g9, cnt_less_g10, cnt_within_g10, cnt_above_g10, cnt_less_g11, cnt_within_g11, cnt_above_g11, cnt_less_g12, cnt_within_g12, cnt_above_g12, aral_math_g1, aral_read_g1, aral_sci_g1, aral_math_g2, sha_category)
    VALUES (NEW.school_id, NEW.iern, NEW.school_name, NEW.region, NEW.division, NEW.province, NEW.municipality, NEW.barangay, NEW.district, NEW.leg_district, NEW.latitude, NEW.longitude, NEW.curricular_offering, NEW.mother_school_id, NEW.email, NEW.updated_at, NEW.submitted_at, NEW.submitted_by, NEW.history_logs, NEW.data_health_score, NEW.data_health_description, NEW.mahalanobis_score, NEW.forms_to_recheck, NEW.forms_completed_count, NEW.completion_percentage, NEW.f1_profile, NEW.f2_head, NEW.f3_enrollment, NEW.f4_classes, NEW.f5_teachers, NEW.f6_specialization, NEW.f7_resources, NEW.f8_facilities, NEW.f9_shifting, NEW.f10_stats, NEW.cnt_within_g5, NEW.aral_read_g2, NEW.aral_sci_g2, NEW.aral_math_g3, NEW.aral_read_g3, NEW.aral_sci_g3, NEW.aral_math_g4, NEW.aral_read_g4, NEW.aral_sci_g4, NEW.aral_math_g5, NEW.aral_read_g5, NEW.aral_sci_g5, NEW.aral_math_g6, NEW.aral_read_g6, NEW.aral_sci_g6, NEW.aral_total, NEW.cnt_less_kinder, NEW.cnt_within_kinder, NEW.cnt_above_kinder, NEW.cnt_less_g1, NEW.cnt_within_g1, NEW.cnt_above_g1, NEW.cnt_less_g2, NEW.cnt_within_g2, NEW.cnt_above_g2, NEW.cnt_less_g3, NEW.cnt_within_g3, NEW.cnt_above_g3, NEW.cnt_less_g4, NEW.cnt_within_g4, NEW.cnt_above_g4, NEW.cnt_less_g5, NEW.cnt_above_g5, NEW.cnt_less_g6, NEW.cnt_within_g6, NEW.cnt_above_g6, NEW.cnt_less_g7, NEW.cnt_within_g7, NEW.cnt_above_g7, NEW.cnt_less_g8, NEW.cnt_within_g8, NEW.cnt_above_g8, NEW.cnt_less_g9, NEW.cnt_within_g9, NEW.cnt_above_g9, NEW.cnt_less_g10, NEW.cnt_within_g10, NEW.cnt_above_g10, NEW.cnt_less_g11, NEW.cnt_within_g11, NEW.cnt_above_g11, NEW.cnt_less_g12, NEW.cnt_within_g12, NEW.cnt_above_g12, NEW.aral_math_g1, NEW.aral_read_g1, NEW.aral_sci_g1, NEW.aral_math_g2, NEW.sha_category)
    ON CONFLICT (school_id) DO UPDATE SET
    iern = EXCLUDED.iern, school_name = EXCLUDED.school_name, region = EXCLUDED.region, division = EXCLUDED.division, province = EXCLUDED.province, municipality = EXCLUDED.municipality, barangay = EXCLUDED.barangay, district = EXCLUDED.district, leg_district = EXCLUDED.leg_district, latitude = EXCLUDED.latitude, longitude = EXCLUDED.longitude, curricular_offering = EXCLUDED.curricular_offering, mother_school_id = EXCLUDED.mother_school_id, email = EXCLUDED.email, updated_at = EXCLUDED.updated_at, submitted_at = EXCLUDED.submitted_at, submitted_by = EXCLUDED.submitted_by, history_logs = EXCLUDED.history_logs, data_health_score = EXCLUDED.data_health_score, data_health_description = EXCLUDED.data_health_description, mahalanobis_score = EXCLUDED.mahalanobis_score, forms_to_recheck = EXCLUDED.forms_to_recheck, forms_completed_count = EXCLUDED.forms_completed_count, completion_percentage = EXCLUDED.completion_percentage, f1_profile = EXCLUDED.f1_profile, f2_head = EXCLUDED.f2_head, f3_enrollment = EXCLUDED.f3_enrollment, f4_classes = EXCLUDED.f4_classes, f5_teachers = EXCLUDED.f5_teachers, f6_specialization = EXCLUDED.f6_specialization, f7_resources = EXCLUDED.f7_resources, f8_facilities = EXCLUDED.f8_facilities, f9_shifting = EXCLUDED.f9_shifting, f10_stats = EXCLUDED.f10_stats, cnt_within_g5 = EXCLUDED.cnt_within_g5, aral_read_g2 = EXCLUDED.aral_read_g2, aral_sci_g2 = EXCLUDED.aral_sci_g2, aral_math_g3 = EXCLUDED.aral_math_g3, aral_read_g3 = EXCLUDED.aral_read_g3, aral_sci_g3 = EXCLUDED.aral_sci_g3, aral_math_g4 = EXCLUDED.aral_math_g4, aral_read_g4 = EXCLUDED.aral_read_g4, aral_sci_g4 = EXCLUDED.aral_sci_g4, aral_math_g5 = EXCLUDED.aral_math_g5, aral_read_g5 = EXCLUDED.aral_read_g5, aral_sci_g5 = EXCLUDED.aral_sci_g5, aral_math_g6 = EXCLUDED.aral_math_g6, aral_read_g6 = EXCLUDED.aral_read_g6, aral_sci_g6 = EXCLUDED.aral_sci_g6, aral_total = EXCLUDED.aral_total, cnt_less_kinder = EXCLUDED.cnt_less_kinder, cnt_within_kinder = EXCLUDED.cnt_within_kinder, cnt_above_kinder = EXCLUDED.cnt_above_kinder, cnt_less_g1 = EXCLUDED.cnt_less_g1, cnt_within_g1 = EXCLUDED.cnt_within_g1, cnt_above_g1 = EXCLUDED.cnt_above_g1, cnt_less_g2 = EXCLUDED.cnt_less_g2, cnt_within_g2 = EXCLUDED.cnt_within_g2, cnt_above_g2 = EXCLUDED.cnt_above_g2, cnt_less_g3 = EXCLUDED.cnt_less_g3, cnt_within_g3 = EXCLUDED.cnt_within_g3, cnt_above_g3 = EXCLUDED.cnt_above_g3, cnt_less_g4 = EXCLUDED.cnt_less_g4, cnt_within_g4 = EXCLUDED.cnt_within_g4, cnt_above_g4 = EXCLUDED.cnt_above_g4, cnt_less_g5 = EXCLUDED.cnt_less_g5, cnt_above_g5 = EXCLUDED.cnt_above_g5, cnt_less_g6 = EXCLUDED.cnt_less_g6, cnt_within_g6 = EXCLUDED.cnt_within_g6, cnt_above_g6 = EXCLUDED.cnt_above_g6, cnt_less_g7 = EXCLUDED.cnt_less_g7, cnt_within_g7 = EXCLUDED.cnt_within_g7, cnt_above_g7 = EXCLUDED.cnt_above_g7, cnt_less_g8 = EXCLUDED.cnt_less_g8, cnt_within_g8 = EXCLUDED.cnt_within_g8, cnt_above_g8 = EXCLUDED.cnt_above_g8, cnt_less_g9 = EXCLUDED.cnt_less_g9, cnt_within_g9 = EXCLUDED.cnt_within_g9, cnt_above_g9 = EXCLUDED.cnt_above_g9, cnt_less_g10 = EXCLUDED.cnt_less_g10, cnt_within_g10 = EXCLUDED.cnt_within_g10, cnt_above_g10 = EXCLUDED.cnt_above_g10, cnt_less_g11 = EXCLUDED.cnt_less_g11, cnt_within_g11 = EXCLUDED.cnt_within_g11, cnt_above_g11 = EXCLUDED.cnt_above_g11, cnt_less_g12 = EXCLUDED.cnt_less_g12, cnt_within_g12 = EXCLUDED.cnt_within_g12, cnt_above_g12 = EXCLUDED.cnt_above_g12, aral_math_g1 = EXCLUDED.aral_math_g1, aral_read_g1 = EXCLUDED.aral_read_g1, aral_sci_g1 = EXCLUDED.aral_sci_g1, aral_math_g2 = EXCLUDED.aral_math_g2, sha_category = EXCLUDED.sha_category;
    

    -- Sync form_school_head
    INSERT INTO form_school_head (school_id, iern, head_last_name, head_first_name, head_middle_name, head_position_title, head_item_number, head_date_hired, school_head_validation)
    VALUES (NEW.school_id, NEW.iern, NEW.head_last_name, NEW.head_first_name, NEW.head_middle_name, NEW.head_position_title, NEW.head_item_number, NEW.head_date_hired, NEW.school_head_validation)
    ON CONFLICT (school_id) DO UPDATE SET
    iern = EXCLUDED.iern, head_last_name = EXCLUDED.head_last_name, head_first_name = EXCLUDED.head_first_name, head_middle_name = EXCLUDED.head_middle_name, head_position_title = EXCLUDED.head_position_title, head_item_number = EXCLUDED.head_item_number, head_date_hired = EXCLUDED.head_date_hired, school_head_validation = EXCLUDED.school_head_validation;
    

    -- Sync form_enrollment
    INSERT INTO form_enrollment (school_id, iern, total_enrollment, es_enrollment, jhs_enrollment, shs_enrollment, grade_kinder, grade_1, grade_2, grade_3, grade_4, grade_5, grade_6, grade_7, grade_8, grade_9, grade_10, grade_11, grade_12, abm_11, abm_12, stem_11, stem_12, humss_11, humss_12, gas_11, gas_12, tvl_ict_11, tvl_ict_12, tvl_he_11, tvl_he_12, tvl_ia_11, tvl_ia_12, tvl_afa_11, tvl_afa_12, arts_11, arts_12, sports_11, sports_12, seats_kinder, seats_grade_1, seats_grade_2, seats_grade_3, seats_grade_4, seats_grade_5, seats_grade_6, seats_grade_7, seats_grade_8, seats_grade_9, seats_grade_10, seats_grade_11, seats_grade_12)
    VALUES (NEW.school_id, NEW.iern, NEW.total_enrollment, NEW.es_enrollment, NEW.jhs_enrollment, NEW.shs_enrollment, NEW.grade_kinder, NEW.grade_1, NEW.grade_2, NEW.grade_3, NEW.grade_4, NEW.grade_5, NEW.grade_6, NEW.grade_7, NEW.grade_8, NEW.grade_9, NEW.grade_10, NEW.grade_11, NEW.grade_12, NEW.abm_11, NEW.abm_12, NEW.stem_11, NEW.stem_12, NEW.humss_11, NEW.humss_12, NEW.gas_11, NEW.gas_12, NEW.tvl_ict_11, NEW.tvl_ict_12, NEW.tvl_he_11, NEW.tvl_he_12, NEW.tvl_ia_11, NEW.tvl_ia_12, NEW.tvl_afa_11, NEW.tvl_afa_12, NEW.arts_11, NEW.arts_12, NEW.sports_11, NEW.sports_12, NEW.seats_kinder, NEW.seats_grade_1, NEW.seats_grade_2, NEW.seats_grade_3, NEW.seats_grade_4, NEW.seats_grade_5, NEW.seats_grade_6, NEW.seats_grade_7, NEW.seats_grade_8, NEW.seats_grade_9, NEW.seats_grade_10, NEW.seats_grade_11, NEW.seats_grade_12)
    ON CONFLICT (school_id) DO UPDATE SET
    iern = EXCLUDED.iern, total_enrollment = EXCLUDED.total_enrollment, es_enrollment = EXCLUDED.es_enrollment, jhs_enrollment = EXCLUDED.jhs_enrollment, shs_enrollment = EXCLUDED.shs_enrollment, grade_kinder = EXCLUDED.grade_kinder, grade_1 = EXCLUDED.grade_1, grade_2 = EXCLUDED.grade_2, grade_3 = EXCLUDED.grade_3, grade_4 = EXCLUDED.grade_4, grade_5 = EXCLUDED.grade_5, grade_6 = EXCLUDED.grade_6, grade_7 = EXCLUDED.grade_7, grade_8 = EXCLUDED.grade_8, grade_9 = EXCLUDED.grade_9, grade_10 = EXCLUDED.grade_10, grade_11 = EXCLUDED.grade_11, grade_12 = EXCLUDED.grade_12, abm_11 = EXCLUDED.abm_11, abm_12 = EXCLUDED.abm_12, stem_11 = EXCLUDED.stem_11, stem_12 = EXCLUDED.stem_12, humss_11 = EXCLUDED.humss_11, humss_12 = EXCLUDED.humss_12, gas_11 = EXCLUDED.gas_11, gas_12 = EXCLUDED.gas_12, tvl_ict_11 = EXCLUDED.tvl_ict_11, tvl_ict_12 = EXCLUDED.tvl_ict_12, tvl_he_11 = EXCLUDED.tvl_he_11, tvl_he_12 = EXCLUDED.tvl_he_12, tvl_ia_11 = EXCLUDED.tvl_ia_11, tvl_ia_12 = EXCLUDED.tvl_ia_12, tvl_afa_11 = EXCLUDED.tvl_afa_11, tvl_afa_12 = EXCLUDED.tvl_afa_12, arts_11 = EXCLUDED.arts_11, arts_12 = EXCLUDED.arts_12, sports_11 = EXCLUDED.sports_11, sports_12 = EXCLUDED.sports_12, seats_kinder = EXCLUDED.seats_kinder, seats_grade_1 = EXCLUDED.seats_grade_1, seats_grade_2 = EXCLUDED.seats_grade_2, seats_grade_3 = EXCLUDED.seats_grade_3, seats_grade_4 = EXCLUDED.seats_grade_4, seats_grade_5 = EXCLUDED.seats_grade_5, seats_grade_6 = EXCLUDED.seats_grade_6, seats_grade_7 = EXCLUDED.seats_grade_7, seats_grade_8 = EXCLUDED.seats_grade_8, seats_grade_9 = EXCLUDED.seats_grade_9, seats_grade_10 = EXCLUDED.seats_grade_10, seats_grade_11 = EXCLUDED.seats_grade_11, seats_grade_12 = EXCLUDED.seats_grade_12;
    

    -- Sync form_organized_classes
    INSERT INTO form_organized_classes (school_id, iern, classes_kinder, classes_grade_1, classes_grade_2, classes_grade_3, classes_grade_4, classes_grade_5, classes_grade_6, classes_grade_7, classes_grade_8, classes_grade_9, classes_grade_10, classes_grade_11, classes_grade_12)
    VALUES (NEW.school_id, NEW.iern, NEW.classes_kinder, NEW.classes_grade_1, NEW.classes_grade_2, NEW.classes_grade_3, NEW.classes_grade_4, NEW.classes_grade_5, NEW.classes_grade_6, NEW.classes_grade_7, NEW.classes_grade_8, NEW.classes_grade_9, NEW.classes_grade_10, NEW.classes_grade_11, NEW.classes_grade_12)
    ON CONFLICT (school_id) DO UPDATE SET
    iern = EXCLUDED.iern, classes_kinder = EXCLUDED.classes_kinder, classes_grade_1 = EXCLUDED.classes_grade_1, classes_grade_2 = EXCLUDED.classes_grade_2, classes_grade_3 = EXCLUDED.classes_grade_3, classes_grade_4 = EXCLUDED.classes_grade_4, classes_grade_5 = EXCLUDED.classes_grade_5, classes_grade_6 = EXCLUDED.classes_grade_6, classes_grade_7 = EXCLUDED.classes_grade_7, classes_grade_8 = EXCLUDED.classes_grade_8, classes_grade_9 = EXCLUDED.classes_grade_9, classes_grade_10 = EXCLUDED.classes_grade_10, classes_grade_11 = EXCLUDED.classes_grade_11, classes_grade_12 = EXCLUDED.classes_grade_12;
    

    -- Sync form_learner_stats
    INSERT INTO form_learner_stats (school_id, iern, stat_sned_es, stat_sned_jhs, stat_sned_shs, stat_disability_es, stat_disability_jhs, stat_disability_shs, stat_als_es, stat_als_jhs, stat_als_shs, stat_muslim_k, stat_muslim_g1, stat_muslim_g2, stat_muslim_g3, stat_muslim_g4, stat_muslim_g5, stat_muslim_g6, stat_muslim_g7, stat_muslim_g8, stat_muslim_g9, stat_muslim_g10, stat_muslim_g11, stat_muslim_g12, stat_ip, stat_displaced, stat_repetition, stat_overage, stat_dropout_prev_sy, stat_ip_es, stat_ip_jhs, stat_ip_shs, stat_displaced_es, stat_displaced_jhs, stat_displaced_shs, stat_repetition_es, stat_repetition_jhs, stat_repetition_shs, stat_overage_es, stat_overage_jhs, stat_overage_shs, stat_dropout_es, stat_dropout_jhs, stat_dropout_shs, stat_sned_k, stat_sned_g1, stat_sned_g2, stat_sned_g3, stat_sned_g4, stat_sned_g5, stat_sned_g6, stat_sned_g7, stat_sned_g8, stat_sned_g9, stat_sned_g10, stat_sned_g11, stat_sned_g12, stat_disability_k, stat_disability_g1, stat_disability_g2, stat_disability_g3, stat_disability_g4, stat_disability_g5, stat_disability_g6, stat_disability_g7, stat_disability_g8, stat_disability_g9, stat_disability_g10, stat_disability_g11, stat_disability_g12, stat_als_k, stat_als_g1, stat_als_g2, stat_als_g3, stat_als_g4, stat_als_g5, stat_als_g6, stat_als_g7, stat_als_g8, stat_als_g9, stat_als_g10, stat_als_g11, stat_als_g12, stat_ip_k, stat_ip_g1, stat_ip_g2, stat_ip_g3, stat_ip_g4, stat_ip_g5, stat_ip_g6, stat_ip_g7, stat_ip_g8, stat_ip_g9, stat_ip_g10, stat_ip_g11, stat_ip_g12, stat_displaced_k, stat_displaced_g1, stat_displaced_g2, stat_displaced_g3, stat_displaced_g4, stat_displaced_g5, stat_displaced_g6, stat_displaced_g7, stat_displaced_g8, stat_displaced_g9, stat_displaced_g10, stat_displaced_g11, stat_displaced_g12, stat_repetition_k, stat_repetition_g1, stat_repetition_g2, stat_repetition_g3, stat_repetition_g4, stat_repetition_g5, stat_repetition_g6, stat_repetition_g7, stat_repetition_g8, stat_repetition_g9, stat_repetition_g10, stat_repetition_g11, stat_repetition_g12, stat_overage_k, stat_overage_g1, stat_overage_g2, stat_overage_g3, stat_overage_g4, stat_overage_g5, stat_overage_g6, stat_overage_g7, stat_overage_g8, stat_overage_g9, stat_overage_g10, stat_overage_g11, stat_overage_g12, stat_dropout_k, stat_dropout_g1, stat_dropout_g2, stat_dropout_g3, stat_dropout_g4, stat_dropout_g5, stat_dropout_g6, stat_dropout_g7, stat_dropout_g8, stat_dropout_g9, stat_dropout_g10, stat_dropout_g11, stat_dropout_g12, learner_stats_grids)
    VALUES (NEW.school_id, NEW.iern, NEW.stat_sned_es, NEW.stat_sned_jhs, NEW.stat_sned_shs, NEW.stat_disability_es, NEW.stat_disability_jhs, NEW.stat_disability_shs, NEW.stat_als_es, NEW.stat_als_jhs, NEW.stat_als_shs, NEW.stat_muslim_k, NEW.stat_muslim_g1, NEW.stat_muslim_g2, NEW.stat_muslim_g3, NEW.stat_muslim_g4, NEW.stat_muslim_g5, NEW.stat_muslim_g6, NEW.stat_muslim_g7, NEW.stat_muslim_g8, NEW.stat_muslim_g9, NEW.stat_muslim_g10, NEW.stat_muslim_g11, NEW.stat_muslim_g12, NEW.stat_ip, NEW.stat_displaced, NEW.stat_repetition, NEW.stat_overage, NEW.stat_dropout_prev_sy, NEW.stat_ip_es, NEW.stat_ip_jhs, NEW.stat_ip_shs, NEW.stat_displaced_es, NEW.stat_displaced_jhs, NEW.stat_displaced_shs, NEW.stat_repetition_es, NEW.stat_repetition_jhs, NEW.stat_repetition_shs, NEW.stat_overage_es, NEW.stat_overage_jhs, NEW.stat_overage_shs, NEW.stat_dropout_es, NEW.stat_dropout_jhs, NEW.stat_dropout_shs, NEW.stat_sned_k, NEW.stat_sned_g1, NEW.stat_sned_g2, NEW.stat_sned_g3, NEW.stat_sned_g4, NEW.stat_sned_g5, NEW.stat_sned_g6, NEW.stat_sned_g7, NEW.stat_sned_g8, NEW.stat_sned_g9, NEW.stat_sned_g10, NEW.stat_sned_g11, NEW.stat_sned_g12, NEW.stat_disability_k, NEW.stat_disability_g1, NEW.stat_disability_g2, NEW.stat_disability_g3, NEW.stat_disability_g4, NEW.stat_disability_g5, NEW.stat_disability_g6, NEW.stat_disability_g7, NEW.stat_disability_g8, NEW.stat_disability_g9, NEW.stat_disability_g10, NEW.stat_disability_g11, NEW.stat_disability_g12, NEW.stat_als_k, NEW.stat_als_g1, NEW.stat_als_g2, NEW.stat_als_g3, NEW.stat_als_g4, NEW.stat_als_g5, NEW.stat_als_g6, NEW.stat_als_g7, NEW.stat_als_g8, NEW.stat_als_g9, NEW.stat_als_g10, NEW.stat_als_g11, NEW.stat_als_g12, NEW.stat_ip_k, NEW.stat_ip_g1, NEW.stat_ip_g2, NEW.stat_ip_g3, NEW.stat_ip_g4, NEW.stat_ip_g5, NEW.stat_ip_g6, NEW.stat_ip_g7, NEW.stat_ip_g8, NEW.stat_ip_g9, NEW.stat_ip_g10, NEW.stat_ip_g11, NEW.stat_ip_g12, NEW.stat_displaced_k, NEW.stat_displaced_g1, NEW.stat_displaced_g2, NEW.stat_displaced_g3, NEW.stat_displaced_g4, NEW.stat_displaced_g5, NEW.stat_displaced_g6, NEW.stat_displaced_g7, NEW.stat_displaced_g8, NEW.stat_displaced_g9, NEW.stat_displaced_g10, NEW.stat_displaced_g11, NEW.stat_displaced_g12, NEW.stat_repetition_k, NEW.stat_repetition_g1, NEW.stat_repetition_g2, NEW.stat_repetition_g3, NEW.stat_repetition_g4, NEW.stat_repetition_g5, NEW.stat_repetition_g6, NEW.stat_repetition_g7, NEW.stat_repetition_g8, NEW.stat_repetition_g9, NEW.stat_repetition_g10, NEW.stat_repetition_g11, NEW.stat_repetition_g12, NEW.stat_overage_k, NEW.stat_overage_g1, NEW.stat_overage_g2, NEW.stat_overage_g3, NEW.stat_overage_g4, NEW.stat_overage_g5, NEW.stat_overage_g6, NEW.stat_overage_g7, NEW.stat_overage_g8, NEW.stat_overage_g9, NEW.stat_overage_g10, NEW.stat_overage_g11, NEW.stat_overage_g12, NEW.stat_dropout_k, NEW.stat_dropout_g1, NEW.stat_dropout_g2, NEW.stat_dropout_g3, NEW.stat_dropout_g4, NEW.stat_dropout_g5, NEW.stat_dropout_g6, NEW.stat_dropout_g7, NEW.stat_dropout_g8, NEW.stat_dropout_g9, NEW.stat_dropout_g10, NEW.stat_dropout_g11, NEW.stat_dropout_g12, NEW.learner_stats_grids)
    ON CONFLICT (school_id) DO UPDATE SET
    iern = EXCLUDED.iern, stat_sned_es = EXCLUDED.stat_sned_es, stat_sned_jhs = EXCLUDED.stat_sned_jhs, stat_sned_shs = EXCLUDED.stat_sned_shs, stat_disability_es = EXCLUDED.stat_disability_es, stat_disability_jhs = EXCLUDED.stat_disability_jhs, stat_disability_shs = EXCLUDED.stat_disability_shs, stat_als_es = EXCLUDED.stat_als_es, stat_als_jhs = EXCLUDED.stat_als_jhs, stat_als_shs = EXCLUDED.stat_als_shs, stat_muslim_k = EXCLUDED.stat_muslim_k, stat_muslim_g1 = EXCLUDED.stat_muslim_g1, stat_muslim_g2 = EXCLUDED.stat_muslim_g2, stat_muslim_g3 = EXCLUDED.stat_muslim_g3, stat_muslim_g4 = EXCLUDED.stat_muslim_g4, stat_muslim_g5 = EXCLUDED.stat_muslim_g5, stat_muslim_g6 = EXCLUDED.stat_muslim_g6, stat_muslim_g7 = EXCLUDED.stat_muslim_g7, stat_muslim_g8 = EXCLUDED.stat_muslim_g8, stat_muslim_g9 = EXCLUDED.stat_muslim_g9, stat_muslim_g10 = EXCLUDED.stat_muslim_g10, stat_muslim_g11 = EXCLUDED.stat_muslim_g11, stat_muslim_g12 = EXCLUDED.stat_muslim_g12, stat_ip = EXCLUDED.stat_ip, stat_displaced = EXCLUDED.stat_displaced, stat_repetition = EXCLUDED.stat_repetition, stat_overage = EXCLUDED.stat_overage, stat_dropout_prev_sy = EXCLUDED.stat_dropout_prev_sy, stat_ip_es = EXCLUDED.stat_ip_es, stat_ip_jhs = EXCLUDED.stat_ip_jhs, stat_ip_shs = EXCLUDED.stat_ip_shs, stat_displaced_es = EXCLUDED.stat_displaced_es, stat_displaced_jhs = EXCLUDED.stat_displaced_jhs, stat_displaced_shs = EXCLUDED.stat_displaced_shs, stat_repetition_es = EXCLUDED.stat_repetition_es, stat_repetition_jhs = EXCLUDED.stat_repetition_jhs, stat_repetition_shs = EXCLUDED.stat_repetition_shs, stat_overage_es = EXCLUDED.stat_overage_es, stat_overage_jhs = EXCLUDED.stat_overage_jhs, stat_overage_shs = EXCLUDED.stat_overage_shs, stat_dropout_es = EXCLUDED.stat_dropout_es, stat_dropout_jhs = EXCLUDED.stat_dropout_jhs, stat_dropout_shs = EXCLUDED.stat_dropout_shs, stat_sned_k = EXCLUDED.stat_sned_k, stat_sned_g1 = EXCLUDED.stat_sned_g1, stat_sned_g2 = EXCLUDED.stat_sned_g2, stat_sned_g3 = EXCLUDED.stat_sned_g3, stat_sned_g4 = EXCLUDED.stat_sned_g4, stat_sned_g5 = EXCLUDED.stat_sned_g5, stat_sned_g6 = EXCLUDED.stat_sned_g6, stat_sned_g7 = EXCLUDED.stat_sned_g7, stat_sned_g8 = EXCLUDED.stat_sned_g8, stat_sned_g9 = EXCLUDED.stat_sned_g9, stat_sned_g10 = EXCLUDED.stat_sned_g10, stat_sned_g11 = EXCLUDED.stat_sned_g11, stat_sned_g12 = EXCLUDED.stat_sned_g12, stat_disability_k = EXCLUDED.stat_disability_k, stat_disability_g1 = EXCLUDED.stat_disability_g1, stat_disability_g2 = EXCLUDED.stat_disability_g2, stat_disability_g3 = EXCLUDED.stat_disability_g3, stat_disability_g4 = EXCLUDED.stat_disability_g4, stat_disability_g5 = EXCLUDED.stat_disability_g5, stat_disability_g6 = EXCLUDED.stat_disability_g6, stat_disability_g7 = EXCLUDED.stat_disability_g7, stat_disability_g8 = EXCLUDED.stat_disability_g8, stat_disability_g9 = EXCLUDED.stat_disability_g9, stat_disability_g10 = EXCLUDED.stat_disability_g10, stat_disability_g11 = EXCLUDED.stat_disability_g11, stat_disability_g12 = EXCLUDED.stat_disability_g12, stat_als_k = EXCLUDED.stat_als_k, stat_als_g1 = EXCLUDED.stat_als_g1, stat_als_g2 = EXCLUDED.stat_als_g2, stat_als_g3 = EXCLUDED.stat_als_g3, stat_als_g4 = EXCLUDED.stat_als_g4, stat_als_g5 = EXCLUDED.stat_als_g5, stat_als_g6 = EXCLUDED.stat_als_g6, stat_als_g7 = EXCLUDED.stat_als_g7, stat_als_g8 = EXCLUDED.stat_als_g8, stat_als_g9 = EXCLUDED.stat_als_g9, stat_als_g10 = EXCLUDED.stat_als_g10, stat_als_g11 = EXCLUDED.stat_als_g11, stat_als_g12 = EXCLUDED.stat_als_g12, stat_ip_k = EXCLUDED.stat_ip_k, stat_ip_g1 = EXCLUDED.stat_ip_g1, stat_ip_g2 = EXCLUDED.stat_ip_g2, stat_ip_g3 = EXCLUDED.stat_ip_g3, stat_ip_g4 = EXCLUDED.stat_ip_g4, stat_ip_g5 = EXCLUDED.stat_ip_g5, stat_ip_g6 = EXCLUDED.stat_ip_g6, stat_ip_g7 = EXCLUDED.stat_ip_g7, stat_ip_g8 = EXCLUDED.stat_ip_g8, stat_ip_g9 = EXCLUDED.stat_ip_g9, stat_ip_g10 = EXCLUDED.stat_ip_g10, stat_ip_g11 = EXCLUDED.stat_ip_g11, stat_ip_g12 = EXCLUDED.stat_ip_g12, stat_displaced_k = EXCLUDED.stat_displaced_k, stat_displaced_g1 = EXCLUDED.stat_displaced_g1, stat_displaced_g2 = EXCLUDED.stat_displaced_g2, stat_displaced_g3 = EXCLUDED.stat_displaced_g3, stat_displaced_g4 = EXCLUDED.stat_displaced_g4, stat_displaced_g5 = EXCLUDED.stat_displaced_g5, stat_displaced_g6 = EXCLUDED.stat_displaced_g6, stat_displaced_g7 = EXCLUDED.stat_displaced_g7, stat_displaced_g8 = EXCLUDED.stat_displaced_g8, stat_displaced_g9 = EXCLUDED.stat_displaced_g9, stat_displaced_g10 = EXCLUDED.stat_displaced_g10, stat_displaced_g11 = EXCLUDED.stat_displaced_g11, stat_displaced_g12 = EXCLUDED.stat_displaced_g12, stat_repetition_k = EXCLUDED.stat_repetition_k, stat_repetition_g1 = EXCLUDED.stat_repetition_g1, stat_repetition_g2 = EXCLUDED.stat_repetition_g2, stat_repetition_g3 = EXCLUDED.stat_repetition_g3, stat_repetition_g4 = EXCLUDED.stat_repetition_g4, stat_repetition_g5 = EXCLUDED.stat_repetition_g5, stat_repetition_g6 = EXCLUDED.stat_repetition_g6, stat_repetition_g7 = EXCLUDED.stat_repetition_g7, stat_repetition_g8 = EXCLUDED.stat_repetition_g8, stat_repetition_g9 = EXCLUDED.stat_repetition_g9, stat_repetition_g10 = EXCLUDED.stat_repetition_g10, stat_repetition_g11 = EXCLUDED.stat_repetition_g11, stat_repetition_g12 = EXCLUDED.stat_repetition_g12, stat_overage_k = EXCLUDED.stat_overage_k, stat_overage_g1 = EXCLUDED.stat_overage_g1, stat_overage_g2 = EXCLUDED.stat_overage_g2, stat_overage_g3 = EXCLUDED.stat_overage_g3, stat_overage_g4 = EXCLUDED.stat_overage_g4, stat_overage_g5 = EXCLUDED.stat_overage_g5, stat_overage_g6 = EXCLUDED.stat_overage_g6, stat_overage_g7 = EXCLUDED.stat_overage_g7, stat_overage_g8 = EXCLUDED.stat_overage_g8, stat_overage_g9 = EXCLUDED.stat_overage_g9, stat_overage_g10 = EXCLUDED.stat_overage_g10, stat_overage_g11 = EXCLUDED.stat_overage_g11, stat_overage_g12 = EXCLUDED.stat_overage_g12, stat_dropout_k = EXCLUDED.stat_dropout_k, stat_dropout_g1 = EXCLUDED.stat_dropout_g1, stat_dropout_g2 = EXCLUDED.stat_dropout_g2, stat_dropout_g3 = EXCLUDED.stat_dropout_g3, stat_dropout_g4 = EXCLUDED.stat_dropout_g4, stat_dropout_g5 = EXCLUDED.stat_dropout_g5, stat_dropout_g6 = EXCLUDED.stat_dropout_g6, stat_dropout_g7 = EXCLUDED.stat_dropout_g7, stat_dropout_g8 = EXCLUDED.stat_dropout_g8, stat_dropout_g9 = EXCLUDED.stat_dropout_g9, stat_dropout_g10 = EXCLUDED.stat_dropout_g10, stat_dropout_g11 = EXCLUDED.stat_dropout_g11, stat_dropout_g12 = EXCLUDED.stat_dropout_g12, learner_stats_grids = EXCLUDED.learner_stats_grids;
    

    -- Sync form_shifting_modalities
    INSERT INTO form_shifting_modalities (school_id, iern, shift_kinder, shift_g1, shift_g2, shift_g3, shift_g4, shift_g5, shift_g6, shift_g7, shift_g8, shift_g9, shift_g10, shift_g11, shift_g12, adm_mdl, adm_odl, adm_tvi, adm_blended, adm_others, mode_kinder, mode_g1, mode_g2, mode_g3, mode_g4, mode_g5, mode_g6, mode_g7, mode_g8, mode_g9, mode_g10, mode_g11, mode_g12)
    VALUES (NEW.school_id, NEW.iern, NEW.shift_kinder, NEW.shift_g1, NEW.shift_g2, NEW.shift_g3, NEW.shift_g4, NEW.shift_g5, NEW.shift_g6, NEW.shift_g7, NEW.shift_g8, NEW.shift_g9, NEW.shift_g10, NEW.shift_g11, NEW.shift_g12, NEW.adm_mdl, NEW.adm_odl, NEW.adm_tvi, NEW.adm_blended, NEW.adm_others, NEW.mode_kinder, NEW.mode_g1, NEW.mode_g2, NEW.mode_g3, NEW.mode_g4, NEW.mode_g5, NEW.mode_g6, NEW.mode_g7, NEW.mode_g8, NEW.mode_g9, NEW.mode_g10, NEW.mode_g11, NEW.mode_g12)
    ON CONFLICT (school_id) DO UPDATE SET
    iern = EXCLUDED.iern, shift_kinder = EXCLUDED.shift_kinder, shift_g1 = EXCLUDED.shift_g1, shift_g2 = EXCLUDED.shift_g2, shift_g3 = EXCLUDED.shift_g3, shift_g4 = EXCLUDED.shift_g4, shift_g5 = EXCLUDED.shift_g5, shift_g6 = EXCLUDED.shift_g6, shift_g7 = EXCLUDED.shift_g7, shift_g8 = EXCLUDED.shift_g8, shift_g9 = EXCLUDED.shift_g9, shift_g10 = EXCLUDED.shift_g10, shift_g11 = EXCLUDED.shift_g11, shift_g12 = EXCLUDED.shift_g12, adm_mdl = EXCLUDED.adm_mdl, adm_odl = EXCLUDED.adm_odl, adm_tvi = EXCLUDED.adm_tvi, adm_blended = EXCLUDED.adm_blended, adm_others = EXCLUDED.adm_others, mode_kinder = EXCLUDED.mode_kinder, mode_g1 = EXCLUDED.mode_g1, mode_g2 = EXCLUDED.mode_g2, mode_g3 = EXCLUDED.mode_g3, mode_g4 = EXCLUDED.mode_g4, mode_g5 = EXCLUDED.mode_g5, mode_g6 = EXCLUDED.mode_g6, mode_g7 = EXCLUDED.mode_g7, mode_g8 = EXCLUDED.mode_g8, mode_g9 = EXCLUDED.mode_g9, mode_g10 = EXCLUDED.mode_g10, mode_g11 = EXCLUDED.mode_g11, mode_g12 = EXCLUDED.mode_g12;
    

    -- Sync form_teaching_personnel
    INSERT INTO form_teaching_personnel (school_id, iern, teach_exp_0_1, teach_exp_2_5, teach_exp_6_10, teach_exp_11_15, teach_exp_16_20, teach_exp_21_25, teach_exp_26_30, teach_exp_31_35, teach_exp_36_40, teach_exp_40_45, teach_kinder, teach_g1, teach_g2, teach_g3, teach_g4, teach_g5, teach_g6, teach_g7, teach_g8, teach_g9, teach_g10, teach_g11, teach_g12, teach_multi_1_2, teach_multi_3_4, teach_multi_5_6, teach_multi_3plus_flag, teach_multi_3plus_count, teachers_es, teachers_jhs, teachers_shs)
    VALUES (NEW.school_id, NEW.iern, NEW.teach_exp_0_1, NEW.teach_exp_2_5, NEW.teach_exp_6_10, NEW.teach_exp_11_15, NEW.teach_exp_16_20, NEW.teach_exp_21_25, NEW.teach_exp_26_30, NEW.teach_exp_31_35, NEW.teach_exp_36_40, NEW.teach_exp_40_45, NEW.teach_kinder, NEW.teach_g1, NEW.teach_g2, NEW.teach_g3, NEW.teach_g4, NEW.teach_g5, NEW.teach_g6, NEW.teach_g7, NEW.teach_g8, NEW.teach_g9, NEW.teach_g10, NEW.teach_g11, NEW.teach_g12, NEW.teach_multi_1_2, NEW.teach_multi_3_4, NEW.teach_multi_5_6, NEW.teach_multi_3plus_flag, NEW.teach_multi_3plus_count, NEW.teachers_es, NEW.teachers_jhs, NEW.teachers_shs)
    ON CONFLICT (school_id) DO UPDATE SET
    iern = EXCLUDED.iern, teach_exp_0_1 = EXCLUDED.teach_exp_0_1, teach_exp_2_5 = EXCLUDED.teach_exp_2_5, teach_exp_6_10 = EXCLUDED.teach_exp_6_10, teach_exp_11_15 = EXCLUDED.teach_exp_11_15, teach_exp_16_20 = EXCLUDED.teach_exp_16_20, teach_exp_21_25 = EXCLUDED.teach_exp_21_25, teach_exp_26_30 = EXCLUDED.teach_exp_26_30, teach_exp_31_35 = EXCLUDED.teach_exp_31_35, teach_exp_36_40 = EXCLUDED.teach_exp_36_40, teach_exp_40_45 = EXCLUDED.teach_exp_40_45, teach_kinder = EXCLUDED.teach_kinder, teach_g1 = EXCLUDED.teach_g1, teach_g2 = EXCLUDED.teach_g2, teach_g3 = EXCLUDED.teach_g3, teach_g4 = EXCLUDED.teach_g4, teach_g5 = EXCLUDED.teach_g5, teach_g6 = EXCLUDED.teach_g6, teach_g7 = EXCLUDED.teach_g7, teach_g8 = EXCLUDED.teach_g8, teach_g9 = EXCLUDED.teach_g9, teach_g10 = EXCLUDED.teach_g10, teach_g11 = EXCLUDED.teach_g11, teach_g12 = EXCLUDED.teach_g12, teach_multi_1_2 = EXCLUDED.teach_multi_1_2, teach_multi_3_4 = EXCLUDED.teach_multi_3_4, teach_multi_5_6 = EXCLUDED.teach_multi_5_6, teach_multi_3plus_flag = EXCLUDED.teach_multi_3plus_flag, teach_multi_3plus_count = EXCLUDED.teach_multi_3plus_count, teachers_es = EXCLUDED.teachers_es, teachers_jhs = EXCLUDED.teachers_jhs, teachers_shs = EXCLUDED.teachers_shs;
    

    -- Sync form_specialization
    INSERT INTO form_specialization (school_id, iern, spec_general_teaching, spec_ece_teaching, spec_bio_sci_major, spec_bio_sci_teaching, spec_phys_sci_major, spec_phys_sci_teaching, spec_agri_fishery_major, spec_agri_fishery_teaching, spec_others_major, spec_others_teaching, spec_general_major, spec_ece_major, spec_english_major, spec_english_teaching, spec_filipino_major, spec_filipino_teaching, spec_math_major, spec_math_teaching, spec_science_major, spec_science_teaching, spec_ap_major, spec_ap_teaching, spec_mapeh_major, spec_mapeh_teaching, spec_esp_major, spec_esp_teaching, spec_tle_major, spec_tle_teaching, spec_guidance, spec_librarian, spec_ict_coord, spec_drrm_coord)
    VALUES (NEW.school_id, NEW.iern, NEW.spec_general_teaching, NEW.spec_ece_teaching, NEW.spec_bio_sci_major, NEW.spec_bio_sci_teaching, NEW.spec_phys_sci_major, NEW.spec_phys_sci_teaching, NEW.spec_agri_fishery_major, NEW.spec_agri_fishery_teaching, NEW.spec_others_major, NEW.spec_others_teaching, NEW.spec_general_major, NEW.spec_ece_major, NEW.spec_english_major, NEW.spec_english_teaching, NEW.spec_filipino_major, NEW.spec_filipino_teaching, NEW.spec_math_major, NEW.spec_math_teaching, NEW.spec_science_major, NEW.spec_science_teaching, NEW.spec_ap_major, NEW.spec_ap_teaching, NEW.spec_mapeh_major, NEW.spec_mapeh_teaching, NEW.spec_esp_major, NEW.spec_esp_teaching, NEW.spec_tle_major, NEW.spec_tle_teaching, NEW.spec_guidance, NEW.spec_librarian, NEW.spec_ict_coord, NEW.spec_drrm_coord)
    ON CONFLICT (school_id) DO UPDATE SET
    iern = EXCLUDED.iern, spec_general_teaching = EXCLUDED.spec_general_teaching, spec_ece_teaching = EXCLUDED.spec_ece_teaching, spec_bio_sci_major = EXCLUDED.spec_bio_sci_major, spec_bio_sci_teaching = EXCLUDED.spec_bio_sci_teaching, spec_phys_sci_major = EXCLUDED.spec_phys_sci_major, spec_phys_sci_teaching = EXCLUDED.spec_phys_sci_teaching, spec_agri_fishery_major = EXCLUDED.spec_agri_fishery_major, spec_agri_fishery_teaching = EXCLUDED.spec_agri_fishery_teaching, spec_others_major = EXCLUDED.spec_others_major, spec_others_teaching = EXCLUDED.spec_others_teaching, spec_general_major = EXCLUDED.spec_general_major, spec_ece_major = EXCLUDED.spec_ece_major, spec_english_major = EXCLUDED.spec_english_major, spec_english_teaching = EXCLUDED.spec_english_teaching, spec_filipino_major = EXCLUDED.spec_filipino_major, spec_filipino_teaching = EXCLUDED.spec_filipino_teaching, spec_math_major = EXCLUDED.spec_math_major, spec_math_teaching = EXCLUDED.spec_math_teaching, spec_science_major = EXCLUDED.spec_science_major, spec_science_teaching = EXCLUDED.spec_science_teaching, spec_ap_major = EXCLUDED.spec_ap_major, spec_ap_teaching = EXCLUDED.spec_ap_teaching, spec_mapeh_major = EXCLUDED.spec_mapeh_major, spec_mapeh_teaching = EXCLUDED.spec_mapeh_teaching, spec_esp_major = EXCLUDED.spec_esp_major, spec_esp_teaching = EXCLUDED.spec_esp_teaching, spec_tle_major = EXCLUDED.spec_tle_major, spec_tle_teaching = EXCLUDED.spec_tle_teaching, spec_guidance = EXCLUDED.spec_guidance, spec_librarian = EXCLUDED.spec_librarian, spec_ict_coord = EXCLUDED.spec_ict_coord, spec_drrm_coord = EXCLUDED.spec_drrm_coord;
    

    -- Sync form_school_resources
    INSERT INTO form_school_resources (school_id, iern, res_toilets_male, res_toilets_female, res_toilets_pwd, res_sci_labs, res_com_labs, res_tvl_workshops, res_toilets_common, res_ecart_func, res_ecart_nonfunc, res_laptop_func, res_laptop_nonfunc, res_tv_func, res_tv_nonfunc, res_printer_func, res_printer_nonfunc, res_desk_func, res_desk_nonfunc, res_armchair_func, res_armchair_nonfunc, res_toilet_func, res_toilet_nonfunc, res_handwash_func, res_handwash_nonfunc, res_water_source, res_electricity_source, res_buildable_space)
    VALUES (NEW.school_id, NEW.iern, NEW.res_toilets_male, NEW.res_toilets_female, NEW.res_toilets_pwd, NEW.res_sci_labs, NEW.res_com_labs, NEW.res_tvl_workshops, NEW.res_toilets_common, NEW.res_ecart_func, NEW.res_ecart_nonfunc, NEW.res_laptop_func, NEW.res_laptop_nonfunc, NEW.res_tv_func, NEW.res_tv_nonfunc, NEW.res_printer_func, NEW.res_printer_nonfunc, NEW.res_desk_func, NEW.res_desk_nonfunc, NEW.res_armchair_func, NEW.res_armchair_nonfunc, NEW.res_toilet_func, NEW.res_toilet_nonfunc, NEW.res_handwash_func, NEW.res_handwash_nonfunc, NEW.res_water_source, NEW.res_electricity_source, NEW.res_buildable_space)
    ON CONFLICT (school_id) DO UPDATE SET
    iern = EXCLUDED.iern, res_toilets_male = EXCLUDED.res_toilets_male, res_toilets_female = EXCLUDED.res_toilets_female, res_toilets_pwd = EXCLUDED.res_toilets_pwd, res_sci_labs = EXCLUDED.res_sci_labs, res_com_labs = EXCLUDED.res_com_labs, res_tvl_workshops = EXCLUDED.res_tvl_workshops, res_toilets_common = EXCLUDED.res_toilets_common, res_ecart_func = EXCLUDED.res_ecart_func, res_ecart_nonfunc = EXCLUDED.res_ecart_nonfunc, res_laptop_func = EXCLUDED.res_laptop_func, res_laptop_nonfunc = EXCLUDED.res_laptop_nonfunc, res_tv_func = EXCLUDED.res_tv_func, res_tv_nonfunc = EXCLUDED.res_tv_nonfunc, res_printer_func = EXCLUDED.res_printer_func, res_printer_nonfunc = EXCLUDED.res_printer_nonfunc, res_desk_func = EXCLUDED.res_desk_func, res_desk_nonfunc = EXCLUDED.res_desk_nonfunc, res_armchair_func = EXCLUDED.res_armchair_func, res_armchair_nonfunc = EXCLUDED.res_armchair_nonfunc, res_toilet_func = EXCLUDED.res_toilet_func, res_toilet_nonfunc = EXCLUDED.res_toilet_nonfunc, res_handwash_func = EXCLUDED.res_handwash_func, res_handwash_nonfunc = EXCLUDED.res_handwash_nonfunc, res_water_source = EXCLUDED.res_water_source, res_electricity_source = EXCLUDED.res_electricity_source, res_buildable_space = EXCLUDED.res_buildable_space;
    

    -- Sync form_physical_facilities
    INSERT INTO form_physical_facilities (school_id, iern, build_classrooms_total, build_classrooms_new, build_classrooms_good, build_classrooms_repair, build_classrooms_demolition)
    VALUES (NEW.school_id, NEW.iern, NEW.build_classrooms_total, NEW.build_classrooms_new, NEW.build_classrooms_good, NEW.build_classrooms_repair, NEW.build_classrooms_demolition)
    ON CONFLICT (school_id) DO UPDATE SET
    iern = EXCLUDED.iern, build_classrooms_total = EXCLUDED.build_classrooms_total, build_classrooms_new = EXCLUDED.build_classrooms_new, build_classrooms_good = EXCLUDED.build_classrooms_good, build_classrooms_repair = EXCLUDED.build_classrooms_repair, build_classrooms_demolition = EXCLUDED.build_classrooms_demolition;
    
    RETURN NEW;
END;
$$ LANGUAGE plpgsql;`;

        console.log("1Ô∏è‚É£  Replacing Function: sync_school_profiles_to_forms...");
        await client.query(fullFunction);

        console.log("2Ô∏è‚É£  Creating Trigger...");
        await client.query('DROP TRIGGER IF EXISTS trigger_sync_to_forms ON school_profiles');
        await client.query(`
            CREATE TRIGGER trigger_sync_to_forms
            AFTER INSERT OR UPDATE ON school_profiles
            FOR EACH ROW EXECUTE FUNCTION sync_school_profiles_to_forms();
        `);

        console.log("‚úÖ Triggers successfully installed!");

    } catch (err) {
        console.error("‚ùå Error:", err);
    } finally {
        client.release();
        await pool.end();
    }
}

createTriggers();
